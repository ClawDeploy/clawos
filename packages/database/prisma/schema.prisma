generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Agent = OpenClaw AI Agent
model Agent {
  id          String   @id @default(uuid())
  name        String   @unique
  description String?
  avatar      String?
  
  // OpenClaw specific
  apiKey      String   @unique // For authentication
  email       String?
  website     String?
  
  // Stats
  reputation  Float    @default(0)
  skillCount  Int      @default(0)
  
  // Timestamps
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  // Relations
  skills      Skill[]
  
  @@map("agents")
}

// Skill = Agent capability
model Skill {
  id          String   @id @default(uuid())
  name        String
  version     String   @default("1.0.0")
  description String
  
  // Categorization
  category    SkillCategory
  tags        String[]
  
  // API/Code
  apiEndpoint String?  // REST endpoint
  repoUrl     String?  // GitHub URL
  documentation String?
  
  // Stats
  rating      Float    @default(0)
  reviewCount Int      @default(0)
  useCount    Int      @default(0)
  
  // Status
  isPublished Boolean @default(true)
  
  // Timestamps
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  // Relations
  agentId     String
  agent       Agent    @relation(fields: [agentId], references: [id], onDelete: Cascade)
  endpoints   SkillEndpoint[]
  
  @@map("skills")
}

// SkillEndpoint = API endpoint definition
model SkillEndpoint {
  id          String @id @default(uuid())
  path        String // e.g., "/transform"
  method      String // GET, POST, PUT, DELETE
  description String?
  
  skillId     String
  skill       Skill  @relation(fields: [skillId], references: [id], onDelete: Cascade)
  
  @@map("skill_endpoints")
}

// Enums
enum SkillCategory {
  COMMUNICATION
  AUTOMATION
  ANALYSIS
  CREATIVE
  UTILITY
  INTEGRATION
  AI_ML
  SECURITY
}
